---
title: "Tarea 1"
output:
  pdf_document: default
  html_document:
    df_print: paged
editor_options: 
  chunk_output_type: inline
---

![](banner.png)

<center> <h1>Tarea 1: Foundations</h1> </center>
<center><strong>CC6104: Statistical Thinking</strong></center>
#### **Integrantes :** 

- Rafael De La Sotta
- Felipe Ort칰zar

#### **Cuerpo Docente:**

- Profesor: Felipe Bravo M.
- Auxiliar: Sebastian Bustos e Ignacio Meza D.
            

#### **Fecha l칤mite de entrega:**

### **칈ndice:**

1. [Objetivo](#id1)
2. [Instrucciones](#id2)
3. [Referencias](#id3)
2. [Primera Parte: Preguntas Te칩ricas](#id4)
3. [Segunda Parte: Elaboraci칩n de C칩digo](#id5)

### **Objetivo**<a name="id1"></a>

Bienvenid@s a la primera tarea del curso Statistical Thinking. Esta tarea tiene como objetivo evaluar los contenidos te칩ricos de la primera parte del curso, los cuales se enfocan principalmente en an치lisis exploratorio de datos y conceptos introductorios de probabilidades. Si a칰n no han visto las clases, se recomienda visitar los enlaces de las referencias.

La tarea consta de una parte te칩rica que busca evaluar conceptos vistos en clases. Seguido por una parte pr치ctica con el f칤n de introducirlos a la programaci칩n en R enfocada en el an치lisis estad칤stico de datos. 

### **Instrucciones:**<a name="id2"></a>

- La tarea se realiza en grupos de **m치ximo 2 personas**. Pero no existe problema si usted desea hacerla de forma individual.
- La entrega es a trav칠s de u-cursos a m치s tardar el d칤a estipulado en la misma plataforma. A las tareas atrasadas se les descontar치 un punto por d칤a.
- El formato de entrega es este mismo **Rmarkdown** y un **html** con la tarea desarrollada. Por favor compruebe que todas las celdas han sido ejecutadas en el archivo html.
- Al momento de la revisi칩n tu c칩digo ser치 ejecutado. Por favor verifica que tu entrega no tenga errores de compilaci칩n.
- No ser치n revisadas tareas desarrolladas en Python.
- Est치 **PROHIBIDO** la copia o compartir las respuestas entre integrantes de diferentes grupos.
- Pueden realizar consultas de la tarea a trav칠s de U-cursos y/o del canal de Discord del curso. 


### **Referencias:**<a name="id3"></a>

Slides de las clases:

- [Introduction to Statistical Thinking](https://github.com/dccuchile/CC6104/blob/master/slides/1_1_ST-intro.pdf)
- [Introduction to R](https://github.com/dccuchile/CC6104/blob/master/slides/1_2_ST-R.pdf)
- [Descriptive Statistics](https://github.com/dccuchile/CC6104/blob/master/slides/1_3_ST-explore.pdf)
- [Probability](https://github.com/dccuchile/CC6104/blob/master/slides/1_4_ST-prob.pdf)

Videos de las clases:

- Introduction to Statistical Thinking: [video1](https://youtu.be/X4SqJu6lExM) [video2](https://youtu.be/YbiQU5TTBX4)
- Introduction to R: [video1](https://youtu.be/MbeLD3hWWVo) [video2](https://youtu.be/9W_eWCy86F4) [video3](https://youtu.be/QvFXSw2-1r4) [video4](https://youtu.be/y4JY7klrbfQ)
- Descriptive Statistics: [video1](https://youtu.be/kWNskZ8_98o) [video2](https://youtu.be/_FJ8x9M4b1w) [video3](https://youtu.be/m7VBNZ2mYWI) [video4](https://youtu.be/ylGMJ_aSQk0)
- Probability: [video1](https://youtu.be/R9AVYV73m1M) [video2](https://youtu.be/zubh1jbRiKE) [video3](https://youtu.be/uiwToagp0z4) [video4](https://youtu.be/RlhN3t_VIyw) [video5](https://youtu.be/4kV1dBaeWVc) [video6](https://youtu.be/MGyXc70JdSk)


# Primera Parte: Preguntas Te칩ricas<a name="id4"></a>
A continuaci칩n, se presentaran diferentes preguntas que abordan las tem치ticas vistas en clases. Por favor responda cada una de estas preguntas de forma breve, no m치s de 4 o 5 lineas.

#### **Pregunta 1:**
쯇or qu칠 la estad칤stica es importante?, 쯈ue nos permite realizar con los datos?. De alg칰n ejemplo.

La estad칤stica tiene como tema central la organizaci칩n y an치lisis de datos. Con ella se puede describir, decidir y predecir a partir de estos. 
La estad칤stica logra transformar los datos en informaci칩n confiable sobre fenomenos, y esta informaci칩n, debido a su confiabilidad, permite predecir, detectar tendencias y tomar desiciones.

#### **Pregunta 2:**
Un amigue cercano a usted le comenta que le preocupa salir a la calle cuando hay ofertas en los helados, esto debido a que ha visto el siguiente titular en un famoso diario chileno: "El aumento en la compra de helados tiene una alta correlaci칩n con la muerte de personas en Santiago". 쯈ue le recomendar칤a a su amigue sobre el titular le칤do?, 쮻eber칤a preocuparse tanto?.

Le dir칤a que tuviera cuidado con mezclar los t칠rminos de correlaci칩n y causalidad. Es posible que la correlaci칩n se deba a que existen m치s muertes en el verano, que es la estaci칩n donde se vende m치s helado, por dar un ejemplo. Es decir, no porque exista correlaci칩n en dos variable signifique que haya una causalidad entre ellas, y por lo tanto lo que le recomendar칤a al amig" es que investigue mejor a la fuente que el diario cita y no lo que sale en el diario chileno, para que encuentre la raz칩n de tal correlaci칩n y as칤 deje probablemente de preocuparse.

#### **Pregunta 3:**
Se침ale las diferentes aplicaciones que poseen las visualizaciones: Boxplot, histograma, gr치fico de pie y scatterplot.

El Boxplot est치 hecho en base a los percentiles. Nos permite identificar la distribuci칩n en base a sus cuartiles, su simetr칤a y sus outliers. A continuaci칩n se muestras sus aplicaci칩nes:

- Boxplot de solo una variable.
- Separa una variable en categorias y hacer boxplot de cada una de estas.
- Comparar distintos boxplot en un mismo gr치fico.

El histograma muestra la distribuci칩n de valores de una variable. Se aplica para descomponer variables con un cierto orden, pues los datos son agrupados en "bins", permitiendo eleg칤r la continuidad del gr치fico. A continuaci칩n se muestras sus aplicaci칩nes:

- Histograma por cantidad.
- Histograma por densidad (치reas deben sumar 1).

El gr치fico de pie es utilizado para mostrar frecuencia de clases en una variable. Normalmente se utiliza para variables categ칩ricas. A continuaci칩n se muestras sus aplicaci칩nes:

- Dos dimensiones
- Tres dimensiones

Scatterplot compara dos variables num칠ricas en un plano carteciano, donde los valores de cada dato determinan su posici칩n. A continuaci칩n se muestras sus aplicaci칩nes:

- Scatterplot entre dos variables numericas.
- Combinaci칩n de scatterplot entre un grupo de variables.
- Scatterplot de tres dimensiones.

#### **Pregunta 4:**
Suponga que esta estudiando la diferencia en los sueldos de las personas que viven en Santiago y Rancagua. Suponiendo que los datos poseen outliers, 쯈ue m칠trica de resumen utilizar칤a para comparar los datos?. Justifique su respuesta.

hint: boxplot pq muestra media, cuartiles y outlayers

boxplot e histograma

> Respuesta Aqu칤

Probablemente utilizar칤a boxplot para aprender sobre estos datos en particular. La raz칩n es que boxplot muestra la mediana, los rangos intercuartiles, el m칤nimo y el m치ximo que son buenas medidas para entender los datos. Pero m치s importante a칰n, boxplot permite visualizar de manera especial a los outliers de los datos, y por lo tanto es una herramienta que los se침ala directamente.

Usando scatter plots o histogramas tambi칠n se podr칤a estudiar el dataset, pero con respecto a los outliers se tendr칤an que identificar de manera visual e indirecta, con mayor dificultad en algunos casos. Por ejemplo en el histograma se podr칤a ver cuando una barra est치 separada del resto de las barras.

Si el dataset contiene outliers que s칩lo son detectables mirando m칰ltiples columnas, entonces es mejor tomar un rumbo m치s matem치tico/programaci칩n para obtener alguna lista o cantidad de outliers.(4 o m치s dimensiones). Con 3 dimensiones todav칤a se podr칤a ocupar un scatter plot en 3D para visualizar la informaci칩n y tratar de encontrar los outliers.

#### **Pregunta 5:**
En base al mismo dataset de sueldos para las regiones de Santiago y Rancagua, le comentan que existe un error en los datos y que estos deben ser modificados aumentando un 10% el valor original y sumando $15.000$ a cada uno de los datos. 쮺omo se ve afectada la media, mediana y desviaci칩n est치ndar con esta modificaci칩n?. Explique a trav칠s de ecuaciones el cambio que experimentan las m칠tricas de resumen respecto al valor original, considere para el caso de la media $\bar{X}_{old} = \dfrac{1}{m} \sum^{m}_{i=1} x_i$ y $sd_{old} = \sqrt{\dfrac{1}{(m-1)}\sum_{i=1}^{m}(x_i-\bar{x})^{2}}$ para la desviaci칩n est치ndar.

- Media

$\bar{X}_{new} = \dfrac{1}{m} \sum^{m}_{i=1} (x_i \cdot 0.1 + 15.000)$ 

$= \bar{X}_{old} \cdot 0.1 + 15.000 \cdot \dfrac{m}{m}$

$= \bar{X}_{old} \cdot 0.1 + 15.000$

- Desviaci칩n est치ndar

$sd_{new} = \sqrt{\dfrac{1}{(m-1)}\sum_{i=1}^{m}(x_i \cdot 0.1 + 15.000 - \bar{x}_{new})^{2}}$

$= \sqrt{\dfrac{1}{(m-1)}\sum_{i=1}^{m}(x_i \cdot 0.1 + 15.000 - (\bar{x}_{old} \cdot 0.1 + 15.000)^{2}}$

$= \sqrt{\dfrac{1}{(m-1)}\sum_{i=1}^{m}(x_i \cdot 0.1 -\bar{x}_{old} \cdot 0.1)^{2}}$

$= \sqrt{\dfrac{1}{(m-1)}\sum_{i=1}^{m}(x_i -\bar{x}_{old})^{2} \cdot  0.1^{2}}$

$= \sqrt{\dfrac{1}{(m-1)}\sum_{i=1}^{m}(x_i -\bar{x}_{old})^{2}} \cdot 0.1$

$= sd_{old} \cdot 0.1$

- Mediana (n par)

$M_{old} = \frac{x_{\frac{n}{2}} + x_{\frac{n}{2} + 1}}{2}$

$M_{new} = \frac{x_{\frac{n}{2}} \cdot 0.1 + 15.000 + x_{\frac{n}{2} + 1} \cdot 0.1 + 15.000}{2}$

$= \frac{x_{\frac{n}{2}} \cdot 0.1 + x_{\frac{n}{2} + 1} \cdot 0.1}{2} + 15.000$

$= \frac{x_{\frac{n}{2}} + x_{\frac{n}{2} + 1}}{2} \cdot 0.1 + 15.000$

$= M_{old} \cdot 0.1 + 15.000$

- Mediana (n impar)

$M_{old} = x_{\frac{n+1}{2}}$

$M_{new} = x_{\frac{n+1}{2}} \cdot 0.1 + 15.000 $

$= M_{old} \cdot 0.1 + 15.000$

- Mediana

$M_{new} = M_{old} \cdot 0.1 + 15.000$


#### **Pregunta 6:**
Suponga que debe responder un examen sorpresa de 10 preguntas, con 5 alternativas por cada pregunta. 쮺ual es la probabilidad de obtener mas de 5 alternativas correctas si responde de forma aleatoria todo el examen?.

**Nota:** Puede resolver el ejercicio desarroll치ndolo a mano o utilizando c칩digo en R. 

> Respuesta Aqu칤

Calculando el binomio de Newton , podemos obtener de cu치ntas maneras sacamos m치s de 5 correctas 
```{r p1}
cant_list <- c(1, 10, 45, 120, 210)
win_prob <- 1/5
total <- 0 
for (i in 0:4){
  total <- total + cant_list[i+1]*((win_prob**(10 - i))*((1- win_prob)**(i)))
}
print(total)

```


#### **Pregunta 7:**
Supongamos que el 10% de los alumnos del curso utilizan Macintosh, el 60% utiliza Windows y el 30% utiliza Linux. Supongamos que el 50% de los usuarios de Mac, el 78% de los usuarios de Windows y el 20% de los usuarios de Linux han sucumbido bajo un terrible virus. Al seleccionar una persona al azar nos enteramos de que su sistema est치 infectado por el virus. 쮺u치l es la probabilidad de que sea un alumno con Windows?.

Por el teroema de Bayes se tiene que 

$P(windows | virus) = \frac{P(virus | windows) \cdot P(windows) }{ P(virus) }$

$= \frac{0.78 \cdot 0.6 }{ 0.1 \cdot 0.5 + 0.6 \cdot 0.78 + 0.3 \cdot 0.2 }$

$= \frac{0.78 \cdot 0.6 }{ 0.578 }$

$= 0.8096886$

#### **Pregunta 8:**
Se침ale si las siguientes declaraciones son verdaderas o falsas respecto a las variables aleatorias:

- [F?] Como las variables aleatorias son funciones que nos permiten obtener valores de probabilidad, siempre podemos obtener $\mathbb{P}(X=x)>0$ evaluando en una $f(x)$ continua y discreta.
- [F] Una PDF bien definida solo puede tener valores menores a 1 y un 치rea debajo de la curva igual a 1.
- [V?] La CDF puede ser representada como la integral de la PDF y PMF.
- [V] Una CDF es definida para todo x, continua hacia la derecha y no es decreciente.

> Respuesta Aqu칤

#### **Pregunta 9:**
Una famosa fabrica de dulces se침ala que solo el $5\%$ de sus dulces contienen menos de $350$ gramos. Si los dulces elaborados por la fabrica distribuyen de forma normal, con media $\mu$ y desviaci칩n est치ndar $11.2$. Responda las siguientes preguntas:

- a) Encuentre la media del producto.
- b) Se침ale el porcentaje de dulces que se encuentran sobre los $390$ gramos.

**Nota:** Puede ser 칰til https://www.statskingdom.com/z_table.html

a) Se normalizan los datos mendiante:

$Z = \frac{x - \mu}{\sigma}$

Luego, se busca en la tabla cual debe ser el valor de Z para que la probabilidad de que un dato sea mayor sea 5$\%$.

$\mathbb{P}(z\leq -1.644854) = 0.05$

Por lo tanto, se tiene que 

$-1.644854 = \frac{350 - \mu}{11.2}$

$\mu = 1.644854 \cdot 11.2 + 350$

$\mu = 368.4224$

a) Se normalizan los datos

$Z = \frac{x - \mu}{\sigma} = \frac{390 - 368.4224}{11.2}  = 1.926571$

Luego se busca el valor en la tabla

$\mathbb{P}(z\leq 1.93) = 0.9725710503$

$\mathbb{P}(z > 1.93) = 1 - \mathbb{P}(z\leq 1.93)$

$\mathbb{P}(z > 1.93) = 0.02742895$

Por lo tanto, existe un 2,7$\%$ de probabilidades de que est칠 sobre los 390.

---

# Segunda Parte: Elaboraci칩n de C칩digo<a name="id5"></a>

En la siguiente secci칩n deber치 resolver cada uno de los experimentos computacionales a trav칠s de la programaci칩n en R. Para esto se le aconseja que cree funciones en R, ya que le facilitar치 la ejecuci칩n de gran parte de lo solicitado.

### Pregunta 1: Visualizaci칩n de Datos

Para esta pregunta usted deber치 trabajar en base al conjunto de datos `hearth_database.csv`, el cual esta compuesto por las siguientes variables:

- target: Se침ala si el paciente tuvo un infarto.
- sex: Sexo de los sujetos de prueba.
- fbs: Az칰car en la sangre con ayunas. Esta variable se침ala solo si se encuentra <=120 o >120.
- exang: Angina de pecho inducida por el ejercicio.
- cp: Tipo de dolor de pecho.
- restecg: Resultados electrocardiogr치ficos en reposo.
- slope: Pendiente del segmento ST m치ximo de ejercicio.
- ca: N칰mero de buques principales.
- thal: Thalassemia.
- age: Edad en a침os.
- trestbps: Presi칩n arterial en reposo.
- chol: colesterol s칠rico en mg/dl.
- thalach: Frecuencia card칤aca m치xima alcanzada.
- oldpeak: Depresi칩n del ST inducida por el ejercicio en relaci칩n con el reposo.

En base al dataset propuesto realice un an치lisis exploratorio de los datos (EDA). Para su an치lisis enfoquen el desarrollo en las siguientes tareas:

- [ ] Obtenga la media, mediana, quintiles y valores m치ximos desde los datos que componen el dataset.
- [ ] Obtenga la Matriz de correlaci칩n de Pearson y visualice la relaci칩n entre las variables num칠ricas.
- [ ] Visualice los boxplot para las variables num칠ricas.
- [ ] Visualice a trav칠s de un histograma como distribuyen las variables respecto a los TARGET.

**Respuesta**
```{r p2 instalation eval=TRUE include=TRUE}
#install.packages("corrplot")
library(corrplot)
```



```{r p2.1.1 eval=TRUE include=TRUE}

data <- read.csv('hearth_database.csv', header = TRUE, sep= ",", quote = '\"')
numeric_columns <- data[, 7:14]

media <- mapply(mean, numeric_columns)
mediana <- mapply(median, numeric_columns)
quintiles <- mapply(quantile, numeric_columns, MoreArgs = list(seq(0, 1, 1/5)))
maximos <- mapply(max, numeric_columns)
print(media)
print(mediana)
print(quintiles)
print(maximos)


```
```{r p2.1.2 eval=TRUE include=TRUE}

numeric_columns.cor <- cor(numeric_columns)
corrplot(numeric_columns.cor)

# Se observa que hay una relaci칩n inversa notable entre slope y oldpeak, y unas menores entre thalach y age, y adem치s thalach y oldpeak. Por otro lado, existe una relaci칩n directa entre slope y thalach.
```

```{r p2.1.3 eval=TRUE include=TRUE}

#NORMAL
boxplot(numeric_columns)
#NORMALIZE BY Z-SCORE
boxplot(scale(numeric_columns))

```


```{r p2.1.4 eval=TRUE include=TRUE}
#install.packages("ggplot2")
library(ggplot2)


#yes_frame <- data[data[, c(1)] == "YES",]
#no_frame  <- data[data[, c(1)] == "NO", ]

#qplot(yes_frame$slope, geom="histogram")

#dat <- data.frame(xx = c(runif(100,20,50),runif(100,40,80),runif(100,0,30)),yy = rep(letters[1:3],each = 100))
data_f <-as.data.frame(data)

ggplot(data_f, aes(x = slope, fill = target)) + geom_bar(position = "identity", alpha = 0.4)
ggplot(data_f, aes(x = ca, fill = target)) + geom_bar(position = "identity", alpha = 0.4)
ggplot(data_f, aes(x = thal, fill = target)) + geom_bar(position = "identity", alpha = 0.4)
ggplot(data_f, aes(x = age, fill = target)) + geom_bar(position = "identity", alpha = 0.4)
ggplot(data_f, aes(x = trestbps, fill = target)) + geom_bar(position = "identity", alpha = 0.4)
ggplot(data_f, aes(x = chol, fill = target)) + geom_bar(position = "identity", alpha = 0.4)
ggplot(data_f, aes(x = thalach, fill = target)) + geom_bar(position = "identity", alpha = 0.4)
ggplot(data_f, aes(x = oldpeak, fill = target)) + geom_bar(position = "identity", alpha = 0.4)

```







### Pregunta 2: Teorema Central del Limite

Pruebe el teorema central del limite aplicando un muestreo de la media en las distribuciones Poisson, Exponencial y una a su elecci칩n. Grafique los resultados obtenidos y se침ale aproximadamente el numero de muestreos necesarios para obtener el resultado esperado, pruebe esto con las siguientes cantidades de muestreo $\{10,100,1000,5000\}$. 쮼l efecto ocurre con el mismo n칰mero de muestreo para todas las distribuciones?.


Por el terorema central del limite (TLC) aplicado a promdeios se tiene que los promedios de una muestra n formar치n una distribuci칩n normal de $\mu = \mu$ y $\sigma^{2} = \frac{\sigma^{2}}{n}$. A continuaci칩n se demuestra esto para distintas distribuciones y n칰mero de muestras. 

####  Dsitribuci칩n de Poisson

```{r eval=FALSE}
# Definici칩n de variables o estructuras necesarias para el muestreo.
n<- 100
lambda_dp = 5

mean_dp <- lambda_dp
var_dp <- lambda_dp

for(n in c(10,100,1000,5000)){
  means_dp <- vector("numeric",n)
  vars_dp <- vector("numeric",n)
  
  for(i in 1:n){
    dp = rpois(n, lambda_dp)
    
    means_dp[i] <- mean(dp)
    vars_dp[i] <- var(dp)
  }
  
  hist(means_dp, main = paste("Promedios de Distribuci칩n Poisson, n =", n, sep=" "), ylab = "Frecuencia", xlab = "Valores")
  abline(v = mean(means_dp), col='blue') 
  abline(v = mean(means_dp)+sqrt(var(means_dp)),col='blue', lty = 2)
  abline(v = mean(means_dp)-sqrt(var(means_dp)),col='blue', lty = 2)
  
  abline(v = mean_dp, col='red') 
  abline(v = mean_dp + sqrt(var_dp/n), col='red',  lty = 2)
  abline(v = mean_dp - sqrt(var_dp/n), col='red',  lty = 2)
  
}

```

####  Dsitribuci칩n Exponencial

```{r eval=FALSE}
# Definici칩n de variables o estructuras necesarias para el muestreo.
n<- 100
lambda_dp = 0.2

mean_de <- lambda_de^(-1)
var_de <- lambda_de^(-2)

for(n in c(10,100,1000,5000)){
  means_de <- vector("numeric",n)
  vars_de <- vector("numeric",n)
  
  for(i in 1:n){
    de = rexp(n, lambda_de)
    
    means_de[i] <- mean(de)
    vars_de[i] <- var(de)
  }
  
  hist(means_de, main = paste("Promedios de Distribuci칩n Exponencial, n =", n, sep=" "), ylab = "Frecuencia", xlab = "Valores")
  abline(v = mean(means_de), col='blue') 
  abline(v = mean(means_de)+sqrt(var(means_de)),col='blue', lty = 2)
  abline(v = mean(means_de)-sqrt(var(means_de)),col='blue', lty = 2)
  
  abline(v = mean_de, col='red') 
  abline(v = mean_de + sqrt(var_de/n), col='red',  lty = 2)
  abline(v = mean_de - sqrt(var_de/n), col='red',  lty = 2)
}

```


####  Dsitribuci칩n Normal

```{r eval=FALSE}
# Definici칩n de variables o estructuras necesarias para el muestreo.

mean_dn <- 0
var_dn <- 1

for(n in c(10,100,1000,5000)){
  means_dn <- vector("numeric",n)
  vars_dn <- vector("numeric",n)
  
  for(i in 1:n){
    dn = rnorm(n)
    
    means_dn[i] <- mean(dn)
    vars_dn[i] <- var(dn)
  }
  
  hist(means_dn, main = paste("Promedios de Distribuci칩n Poisson, n =", n, sep=" "), ylab = "Frecuencia", xlab = "Valores")
  abline(v = mean(means_dn), col='blue') 
  abline(v = mean(means_dn)+sqrt(var(means_dn)),col='blue', lty = 2)
  abline(v = mean(means_dn)-sqrt(var(means_dn)),col='blue', lty = 2)
  
  abline(v = mean_dn, col='red') 
  abline(v = mean_dn + sqrt(var_dn/n), col='red',  lty = 2)
  abline(v = mean_dn - sqrt(var_dn/n), col='red',  lty = 2)
}

```


---

### Pregunta 3: Ley de los Grandes Numeros.

#### Lanzamiento de monedas
Realice el experimento de lanzar una moneda cargada 1000 veces y observe el comportamiento que tiene la probabilidad de salir cara. Para realizar el experimento considere que la moneda tiene una probabilidad de $4/5$ de salir cara. Grafique el experimento para las secuencias de intentos que van desde 1 a 1000, se침alando el valor en que converge la probabilidad de salir cara.

**Respuesta**

```{r eval=TRUE}
# Simular lanzamientos

lanzamientos <- runif(1000, 1, 100)
comportamiento <- lanzamientos >= 20
list_ratio <- data.frame(1:1000)
suma_true <- 0
suma_falsa <- 0
for (tirada  in comportamiento){
  if (tirada){suma_true  <- suma_true  + 1}
  else{       suma_falsa <- suma_falsa + 1}
  list_ratio[1+suma_falsa+suma_true, 1] <- suma_true/(suma_falsa + suma_true)
}
plot(c(0:1000), c(list_ratio$X1.100), type = "l")
# Gr치fico de la convergencia
```

#### El problema de Monty Hall 

Remont치ndonos en la televisi칩n del a침o 1963, en USA exist칤a un programa de concursos donde los participantes deb칤an escoger entre 3 puertas para ganar un premio so침ado. El problema del concurso era que solo detr치s de 1 puerta estaba el premio mayor, mientras que detr치s de las otras dos hab칤an cabras como "premio". 

Una de las particularidades de este concurso, es que cuando el participante escog칤a una puerta, el animador del show abr칤a una de las puertas que no fue escogida por el participante (Obviamente la puerta abierta por el animador no conten칤a el premio). Tras abrir la puerta, el animador consultaba al participante si su elecci칩n era definitiva, o si deseaba cambiar la puerta escogida por la otra puerta cerrada.

Imagine que usted es participante del concurso y desea calcular la probabilidad de ganar el gran premio **si cambia de puerta** en el momento que el animador se lo ofrece. Utilizando listas/arrays/vectores simule las puertas del concurso, dejando aleatoriamente el premio en alguna posici칩n del array. Hecho esto, genere un numero de forma aleatoria para escoger una de las puerta (posiciones de la estructura), para luego ver si cambiando de posici칩n tendr치 mayores posibilidades de ganar el premio. Genere N veces el experimento y grafique cada una de las iteraciones, tal como se hizo en el ejercicio de las monedas.

<p align="center">
  <img src="https://brilliant-staff-media.s3-us-west-2.amazonaws.com/tiffany-wang/gWotbuEdYC.png" width="350">
</p>


**Respuesta:**

```{r eval=FALSE}
# Creamos una funci칩n que simule el juego
montyhall <- function(cambiar = TRUE){
  Puertas <- sample(1:3,3)             #Puertas donde la posici칩n que tiene el 3 es el premio
  posicion <- sample(1:3,1)            #Elecci칩n del participante.
  
  return(Eleccion) # Retornamos la elecci칩n, esta puede que tenga el premio o no
}

# Funci칩n que simula N juegos
n_juegos <- function(n = 10 ,cambiar_puerta = TRUE){
  
}
```

---

### Pregunta 4: 쯀ndependencia?
Ustedes disponen de los dados D1 y D2, los cuales no est치n cargados y son utilizados para comprobar que $\mathbb{P}(AB)=\mathbb{P}(A)\mathbb{P}(B)$ cuando el evento A es independiente del B. Para estudiar la independencia considere que los eventos A y B se definen de la siguiente manera; sea A el evento dado por los valores obtenidos en el lanzamiento del dado D1, este est치 compuesto por $A=\{D1=1,D1=2,D1=6\}$. Por otro lado, el evento B viene dado por los valores obtenidos con el dado D2, el que est치 conformado por $B=\{D2=1,D2=2,D2=3,D2=4\}$. Con esto, tendremos un $\mathbb{P}(A)=1/2$, $\mathbb{P}(洧냣)=2/3$ y $\mathbb{P}(AB)=1/3$. Compruebe de forma gr치fica que al realizar 1000 lanzamientos (u otro valor grande que usted desea probar) se visualiza que $\mathbb{P}(AB)=\mathbb{P}(A)\mathbb{P}(B)$. 

Hecho lo anterior, compruebe el comportamiento de un segundo grupo de eventos, dados por el lanzamiento de solo el dado D1. Donde, los eventos para D1 quedan definidos como: $A =\{D1=1,D1=2,D1=6\}$ y $B=\{D1=1,D1=2,D1=3\}$. 쯉e observa independencia en este experimento?.

Se le aconseja que para simular los lanzamientos de dados utilice la funci칩n `sample()` para generar valores aleatorios entre 1 y 6. Compruebe los n칰meros generados por la funci칩n con los casos favorables de cada uno de los eventos a ser estudiados.

** Lanzamiento de dados **

```{r eval=FALSE}
N_lan <- 1000 # Numero de lanzamientos

vec_D1 <- sample(1:6, size = N_lan, replace = TRUE)
vec_D2 <- sample(1:6, size = N_lan, replace = TRUE)
```

** Eventos independientes **

```{r eval=FALSE}
cond_A <- vec_D1 %in% c(1,2,6)
cond_B <- vec_D2 %in% c(1,2,3,4)

L_A  <- sum(cond_A , na.rm=TRUE)          # Lanzamientos favorables A = c(1, 2, 6)
L_B  <- sum(cond_B , na.rm=TRUE)          # Lanzamientos favorables B = c(1, 2, 3, 4)
L_AB <- sum(cond_A & cond_B, na.rm=TRUE)  # Lanzamientos favorables AB = c(1, 2)

P_A <- L_A/N_lan
P_B <-  L_B/N_lan

P_AB <- L_AB/N_lan
PA_PB <- P_A*P_B

message("P(AB): ", P_AB)
message("P(A)P(B): ", PA_PB)
```


```{r eval=FALSE}
list_P_AB <- c(1:1000)  # probabilidad de ambas
list_PA_PB <- c(1:1000) # producto

suma_true_A <- 0
suma_true_B <- 0
suma_true_AB <- 0
count <- 0

for (i in 1:N_lan){
  if (cond_A[i]){suma_true_A  <- suma_true_A  + 1}
  if (cond_B[i]){suma_true_B  <- suma_true_B  + 1}
  if (cond_A[i] & cond_B[i]){suma_true_AB  <- suma_true_AB  + 1}
  count <- count + 1
  
  P_A <- suma_true_A/(count)
  P_B <- suma_true_B/(count)
  P_AB <- suma_true_AB/(count)
  PA_PB <- P_A * P_B
  
  list_P_AB[count] <- P_AB
  list_PA_PB[count] <- PA_PB
}
plot(c(1:1000), list_P_AB, type = "l", col = "blue", xlim=c(1,1000), ylim=c(0,1))
lines(c(1:1000), list_PA_PB, type = "l", col = "orange")

legend(800, 0.9, legend=c("P(AB)", "P(A)P(B)"),
       col=c("blue", "orange"), lty=1:2, cex=0.8)
```

** Eventos dependientes **

```{r eval=FALSE}
cond_A <- vec_D1 %in% c(1,2,6)
cond_B <- vec_D1 %in% c(1,2,3,4)

L_A <- sum(cond_A , na.rm=TRUE) # Lanzamientos favorables A = c(1, 2, 6)
L_B <- sum(cond_B , na.rm=TRUE) # Lanzamientos favorables B = c(1, 2, 3, 4)
L_AB <- sum( cond_A & cond_B, na.rm=TRUE) # Lanzamientos favorables AB = c(1, 2)

P_A <- L_A/N_lan
P_B <- L_B/N_lan
P_AB <- L_AB/N_lan
PA_PB <- P_A*P_B

message("P(AB): ", P_AB)
message("P(A)P(B): ", PA_PB)
```



```{r eval=FALSE}
list_P_AB <- c(1:1000)  # probabilidad de ambas
list_PA_PB <- c(1:1000) # producto

suma_true_A <- 0
suma_true_B <- 0
suma_true_AB <- 0
count <- 0

for (i in 1:N_lan){
  if (cond_A[i]){suma_true_A  <- suma_true_A  + 1}
  if (cond_B[i]){suma_true_B  <- suma_true_B  + 1}
  if (cond_A[i] & cond_B[i]){suma_true_AB  <- suma_true_AB  + 1}
  count <- count + 1
  
  P_A <- suma_true_A/(count)
  P_B <- suma_true_B/(count)
  P_AB <- suma_true_AB/(count)
  PA_PB <- P_A * P_B
  
  list_P_AB[count] <- P_AB
  list_PA_PB[count] <- PA_PB
}
plot(c(1:1000), list_P_AB, type = "l", col = "blue", xlim=c(1,1000), ylim=c(0,1))
lines(c(1:1000), list_PA_PB, type = "l", col = "orange")

legend(800, 0.9, legend=c("P(AB)", "P(A)P(B)"),
       col=c("blue", "orange"), lty=1:2, cex=0.8)
```





---

### Pregunta 5: La Ruina del Jugador
Un amigo lud칩pata suyo le comenta que el truco de jugar en el casino esta en no parar de apostar y apostando lo m칤nimo posible. Ya que as칤, tienes mas probabilidades de ganar el gran pozo que acumula el juego. Usted sabiendo la condici칩n de su amigo, decide no creer en su conjetura y decide probar esto a trav칠s de un experimento.

Para realizar el experimento usted decide asumir las siguientes declaraciones, bajo sus observaciones:

- La probabilidad de ganar en un juego del casino es $9/19$
- Sabe que su amigo posee fondos en el rango de 0 a 200 dolares.
- Las apuestas como m칤nimo deben ser igual a 5 dolares.
- El monto de las apuestas no cambia y son siempre igual a la primera. Por ejemplo, si su amigo apuesta 50 dolares, todos los pr칩ximos juegos apuesta 50 hasta que se acaba su dinero.
- Asuma que al momento de ganar el jugador anexa el valor apostado a sus fondos.

En el experimento deber치 obtener la evoluci칩n de los fondos hasta que el jugador se queda sin fondos para jugar. Puede ser 칰til seguir la l칩gica de una moneda cargada para realizar esto. Pruebe esto con una apuesta igual a 5, 25 y 50 graficando los resultados. Comente los resultados obtenidos.

**Respuesta**

```{r eval=FALSE}
# Funci칩n para obtener el desarrollo de las apuestas
ruina <- function(fondos = 1000, apuesta = 5){
  win_prob <- 9/19
  vec_fondos <- c()
  while (0<fondos & fondos<2000) {
    
    dado <- runif(1, 0, 1)
    fondos <- fondos + ((dado<win_prob) - (dado>=win_prob))*apuesta
    vec_fondos <- rbind(vec_fondos, fondos)
    
  }
  print(vec_fondos)
  return(vec_fondos) # Devuelve un vector con el desarrollo de los fondos
}

plot(ruina(), type="l", col="blue", xlab="N춿 de juegos", ylab="Fondos", main="Evoluci칩n de los fondos (apuesta = 5)")
plot(ruina(apuesta = 25), type="l", col="blue", xlab="N춿 de juegos", ylab="Fondos", main="Evoluci칩n de los fondos (apuesta = 25)")
plot(ruina(apuesta = 50), type="l", col="blue", xlab="N춿 de juegos", ylab="Fondos", main="Evoluci칩n de los fondos (apuesta = 50)")
```

Viendo los resultados, y repitiendo el experimento varias veces y con diferentes variables, podemos observar que si la probabilidad de ganar la apuesta es menor a un 50%, es altamente probable que ha medida que vayan ocurriendo m치s juegos la persona ir치 perdiendo m치s dinero.

&nbsp;
<hr />
<p style="text-align: center;">A work by <a href="https://github.com/dccuchile/CC6104">CC6104</a></p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/dccuchile/CC6104"><i class="fab fa-github" style='font-size:30px'></i></a>
</p>

&nbsp;