my_dat<- read.csv('insurance.csv', header = TRUE, sep= ",", quote = '\"')
View(my_dat)
my_dat <-  my_dat[c(1, 3, 4, 7)]
my_dat<- read.csv('insurance.csv', header = TRUE, sep= ",", quote = '\"')
my_dat <-  my_dat[c(1, 3, 4, 5, 7)]
fumadores <- my_dat[my_dat$smoker == 'yes']
fumadores <- my_dat[my_dat$smoker == 'yes', ]
View(fumadores)
c(1, 2, 3, 4) - 5
c(1, 2, 3, 4) * c(2, 3, 4, 5)
c(1, 2)^2
my_dat<- read.csv('insurance.csv', header = TRUE, sep= ",", quote = '\"')
my_dat <-  my_dat[c(1, 3, 4, 5, 7)]
fumadores    <- my_dat[my_dat$smoker == 'yes', ]
no_fumadores <- my_dat[my_dat$smoker == 'no' , ]
mod_lin_funct <- function(x, y){
media_x = mean(x); media_y = mean(y)
dif_x <- x - media(x)
dif_y <- y - media(y)
b_1 <- sum(dif_x * dif_y) / sum(dif_x ^ 2)
b_0 <- media_y - b_1 * media_x
c(b_0, b_1)
}
hola <- mod_lin_funct(fumadores$age, fumadores$charges)
my_dat<- read.csv('insurance.csv', header = TRUE, sep= ",", quote = '\"')
my_dat <-  my_dat[c(1, 3, 4, 5, 7)]
fumadores    <- my_dat[my_dat$smoker == 'yes', ]
no_fumadores <- my_dat[my_dat$smoker == 'no' , ]
mod_lin_funct <- function(x, y){
media_x = mean(x); media_y = mean(y)
dif_x <- x - media_x
dif_y <- y - media_y
b_1 <- sum(dif_x * dif_y) / sum(dif_x ^ 2)
b_0 <- media_y - b_1 * media_x
c(b_0, b_1)
}
hola <- mod_lin_funct(fumadores$age, fumadores$charges)
my_dat<- read.csv('insurance.csv', header = TRUE, sep= ",", quote = '\"')
my_dat <-  my_dat[c(1, 3, 4, 5, 7)]
fumadores    <- my_dat[my_dat$smoker == 'yes', ]
no_fumadores <- my_dat[my_dat$smoker == 'no' , ]
mod_lin_funct <- function(x, y){
media_x = mean(x); media_y = mean(y)
dif_x <- x - media_x
dif_y <- y - media_y
b_1 <- sum(dif_x * dif_y) / sum(dif_x ^ 2)
b_0 <- media_y - b_1 * media_x
c(b_0, b_1)
}
fum_age <- mod_lin_funct(fumadores$age, fumadores$charges)
fum_bmi <- mod_lin_funct(fumadores$bmi, fumadores$charges)
fum_children <- mod_lin_funct(fumadores$children, fumadores$charges)
no_fum_age <- mod_lin_funct(no_fumadores$age, no_fumadores$charges)
no_fum_bmi <- mod_lin_funct(no_fumadores$bmi, no_fumadores$charges)
no_fum_children <- mod_lin_funct(no_fumadores$children, no_fumadores$charges)
resultados <- data.frame("b_0", "b_1")
rbind(resultados, fum_age)
my_dat<- read.csv('insurance.csv', header = TRUE, sep= ",", quote = '\"')
my_dat <-  my_dat[c(1, 3, 4, 5, 7)]
fumadores    <- my_dat[my_dat$smoker == 'yes', ]
no_fumadores <- my_dat[my_dat$smoker == 'no' , ]
mod_lin_funct <- function(x, y){
media_x = mean(x); media_y = mean(y)
dif_x <- x - media_x
dif_y <- y - media_y
b_1 <- sum(dif_x * dif_y) / sum(dif_x ^ 2)
b_0 <- media_y - b_1 * media_x
c(b_0, b_1)
}
fum_age <- mod_lin_funct(fumadores$age, fumadores$charges)
fum_bmi <- mod_lin_funct(fumadores$bmi, fumadores$charges)
fum_children <- mod_lin_funct(fumadores$children, fumadores$charges)
no_fum_age <- mod_lin_funct(no_fumadores$age, no_fumadores$charges)
no_fum_bmi <- mod_lin_funct(no_fumadores$bmi, no_fumadores$charges)
no_fum_children <- mod_lin_funct(no_fumadores$children, no_fumadores$charges)
resultados <- data.frame("b_0", "b_1")
rbind(resultados, fum_age)
rbind(resultados, fum_bmi)
rbind(resultados, fum_children)
rbind(resultados, no_fum_age)
rbind(resultados, no_fum_bmi)
rbind(resultados, no_fum_children)
View(resultados)
my_dat<- read.csv('insurance.csv', header = TRUE, sep= ",", quote = '\"')
my_dat <-  my_dat[c(1, 3, 4, 5, 7)]
fumadores    <- my_dat[my_dat$smoker == 'yes', ]
no_fumadores <- my_dat[my_dat$smoker == 'no' , ]
mod_lin_funct <- function(x, y){
media_x = mean(x); media_y = mean(y)
dif_x <- x - media_x
dif_y <- y - media_y
b_1 <- sum(dif_x * dif_y) / sum(dif_x ^ 2)
b_0 <- media_y - b_1 * media_x
c(b_0, b_1)
}
fum_age <- mod_lin_funct(fumadores$age, fumadores$charges)
fum_bmi <- mod_lin_funct(fumadores$bmi, fumadores$charges)
fum_children <- mod_lin_funct(fumadores$children, fumadores$charges)
no_fum_age <- mod_lin_funct(no_fumadores$age, no_fumadores$charges)
no_fum_bmi <- mod_lin_funct(no_fumadores$bmi, no_fumadores$charges)
no_fum_children <- mod_lin_funct(no_fumadores$children, no_fumadores$charges)
resultados <- data.frame("b_0" <- c(fum_age, fum_bmi, fum_children),
"b_1" <-c(no_fum_age, no_fum_bmi, no_fum_children))
View(resultados)
b_0 <- c(fum_age, fum_bmi, fum_children)
b_1 <-c(no_fum_age, no_fum_bmi, no_fum_children)
resultados <- data.frame(b_0, b_1)
Tags <- c("fum_age", "fum_bmi", "fum_children",
"no_fum_age", "no_fum_bmi", "no_fum_children")
b_0 <- c(fum_age, fum_bmi, fum_children)
b_1 <-c(no_fum_age, no_fum_bmi, no_fum_children)
resultados <- data.frame(Tags, b_0, b_1)
size(c(1, 2, 3))
length(c(1, 2, 3, 4))
my_dat<- read.csv('insurance.csv', header = TRUE, sep= ",", quote = '\"')
my_dat <-  my_dat[c(1, 3, 4, 5, 7)]
fumadores    <- my_dat[my_dat$smoker == 'yes', ]
no_fumadores <- my_dat[my_dat$smoker == 'no' , ]
mod_lin_funct <- function(x, y){
media_x = mean(x); media_y = mean(y)
dif_x <- x - media_x
dif_y <- y - media_y
b_1 <- sum(dif_x * dif_y) / sum(dif_x ^ 2)
b_0 <- media_y - b_1 * media_x
y_gorro <- b_0 + x * b_1
SSM <- sum((y_gorro - media_y)^2)
SST <- sum((y - media_y)^2)
r_sqr <- SSM / SST
N = length(x); k = 1
r_sqr_a <- 1 - ((N - 1)/(N - k - 1))*(1 - r_sqr)
data.frame(b_0, b_1, r_sqr, r_sqr_a)
}
fum_age <- mod_lin_funct(fumadores$age, fumadores$charges)
fum_bmi <- mod_lin_funct(fumadores$bmi, fumadores$charges)
fum_children <- mod_lin_funct(fumadores$children, fumadores$charges)
no_fum_age <- mod_lin_funct(no_fumadores$age, no_fumadores$charges)
no_fum_bmi <- mod_lin_funct(no_fumadores$bmi, no_fumadores$charges)
no_fum_children <- mod_lin_funct(no_fumadores$children, no_fumadores$charges)
Tags <- c("fum_age", "fum_bmi", "fum_children",
"no_fum_age", "no_fum_bmi", "no_fum_children")
b_0 <- c(fum_age$b_0, fum_bmi$b_0, fum_children$b_0,
no_fum_age$b_0, no_fum_bmi$b_0, no_fum_children$b_0)
b_1 <-c(fum_age$b_1, fum_bmi$b_1, fum_children$b_1,
no_fum_age$b_1, no_fum_bmi$b_1, no_fum_children$b_1)
r_sqr <- c(fum_age$r_sqr, fum_bmi$r_sqr, fum_children$r_sqr,
no_fum_age$r_sqr, no_fum_bmi$r_sqr, no_fum_children$r_sqr)
r_sqr_a <- c(fum_age$r_sqr_a, fum_bmi$r_sqr_a, fum_children$r_sqr_a,
no_fum_age$r_sqr_a, no_fum_bmi$r_sqr_a, no_fum_children$r_sqr_a)
resultados <- data.frame(Tags, b_0, b_1)
my_dat<- read.csv('insurance.csv', header = TRUE, sep= ",", quote = '\"')
my_dat <-  my_dat[c(1, 3, 4, 5, 7)]
fumadores    <- my_dat[my_dat$smoker == 'yes', ]
no_fumadores <- my_dat[my_dat$smoker == 'no' , ]
mod_lin_funct <- function(x, y){
media_x = mean(x); media_y = mean(y)
dif_x <- x - media_x
dif_y <- y - media_y
b_1 <- sum(dif_x * dif_y) / sum(dif_x ^ 2)
b_0 <- media_y - b_1 * media_x
y_gorro <- b_0 + x * b_1
SSM <- sum((y_gorro - media_y)^2)
SST <- sum((y - media_y)^2)
r_sqr <- SSM / SST
N = length(x); k = 1
r_sqr_a <- 1 - ((N - 1)/(N - k - 1))*(1 - r_sqr)
data.frame(b_0, b_1, r_sqr, r_sqr_a)
}
fum_age <- mod_lin_funct(fumadores$age, fumadores$charges)
fum_bmi <- mod_lin_funct(fumadores$bmi, fumadores$charges)
fum_children <- mod_lin_funct(fumadores$children, fumadores$charges)
no_fum_age <- mod_lin_funct(no_fumadores$age, no_fumadores$charges)
no_fum_bmi <- mod_lin_funct(no_fumadores$bmi, no_fumadores$charges)
no_fum_children <- mod_lin_funct(no_fumadores$children, no_fumadores$charges)
Tags <- c("fum_age", "fum_bmi", "fum_children",
"no_fum_age", "no_fum_bmi", "no_fum_children")
b_0 <- c(fum_age$b_0, fum_bmi$b_0, fum_children$b_0,
no_fum_age$b_0, no_fum_bmi$b_0, no_fum_children$b_0)
b_1 <-c(fum_age$b_1, fum_bmi$b_1, fum_children$b_1,
no_fum_age$b_1, no_fum_bmi$b_1, no_fum_children$b_1)
r_sqr <- c(fum_age$r_sqr, fum_bmi$r_sqr, fum_children$r_sqr,
no_fum_age$r_sqr, no_fum_bmi$r_sqr, no_fum_children$r_sqr)
r_sqr_a <- c(fum_age$r_sqr_a, fum_bmi$r_sqr_a, fum_children$r_sqr_a,
no_fum_age$r_sqr_a, no_fum_bmi$r_sqr_a, no_fum_children$r_sqr_a)
resultados <- data.frame(Tags, b_0, b_1, r_sqr, r_sqr_a)
plot(resultados)
print(resultados)
ggplot(fumadores, aes(x=bmi, y=charges)) +
geom_point(size=2, shape=23)
library(ggplot2)
ggplot(fumadores, aes(x=bmi, y=charges)) +
geom_point(size=2, shape=23)
library(ggplot2)
ggplot(fumadores, aes(x=age, y=charges)) +
geom_point(size=2, shape=23)
library(ggplot2)
ggplot(fumadores, aes(x=children, y=charges)) +
geom_point(size=2, shape=23)
ggplot(fumadores, aes(x=bmi, y=charges)) +
geom_point(size=2, shape=23)
library(ggplot2)
ggplot(fumadores, aes(x=bmi, y=charges)) +
geom_point(size=2, shape=23) +
geom_line()
c(1, 2, 3)[, 3]
c(1, 2, 3)[, 2]
c(1, 2, 3)[2]
library(ggplot2)
ggplot(fumadores, aes(x=bmi, y=charges)) +
geom_point(size=2, shape=23) +
geom_line(y = fum_bmi[0] * bmi + fum_bmi[1])
library(ggplot2)
ggplot(fumadores, aes(x=bmi, y=charges)) +
geom_point(size=2, shape=23) +
geom_line(y = fum_bmi[0] * fumadores$bmi + fum_bmi[1])
fum_bmi[0]
fum_bmi
fum_bmi[1, 0]
fum_bmi[1, 0][0]
fum_bmi(1, 0)
fum_bmi[1, 0]
fum_bmi[1, 1]
library(ggplot2)
ggplot(fumadores, aes(x=bmi, y=charges)) +
geom_point(size=2, shape=23) +
geom_line(y = fum_bmi[1, 1] * fumadores$bmi + fum_bmi[1, 2])
library(ggplot2)
ggplot(fumadores, aes(x=bmi, y=charges)) +
geom_point(size=2, shape=23) +
geom_line(y = (fum_bmi[1, 1] * fumadores$bmi + fum_bmi[1, 2]))
fum_bmi[1, 1] * fumadores$bmi + fum_bmi[1, 2])
fum_bmi[1, 1] * fumadores$bmi + fum_bmi[1, 2]
library(ggplot2)
ggplot(fumadores, aes(x=bmi, y=charges)) +
geom_point(size=2, shape=23) +
geom_line(y = (fum_bmi[1, 1] + fumadores$bmi * fum_bmi[1, 2]))
fum_bmi[1, 1] + fumadores$bmi * fum_bmi[1, 2]
fumadores$bmi
sort(c(1, 2, 4, 3))
library(ggplot2)
ggplot(fumadores, aes(x=bmi, y=charges)) +
geom_point(size=2, shape=23) +
geom_line(y = (fum_bmi[1, 1] + sort(fumadores$bmi) * fum_bmi[1, 2]))
library(ggplot2)
ggplot(fumadores, aes(x=bmi, y=charges)) +
geom_point(size=2, shape=23) +
geom_line(y = (fum_children[1, 1] + sort(fumadores$bmi) * fum_children[1, 2]))
ggplot(no_fumadores, aes(x=children, y=charges)) +
geom_point(size=2, shape=23) +
geom_line(y = (fum_children[1, 1] + sort(no_fumadores$children) * fum_children[1, 2]))
library(ggplot2)
ggplot(fumadores, aes(x=bmi, y=charges)) +
geom_point(size=2, shape=23) +
geom_line(y = (fum_children[1, 1] + sort(fumadores$bmi) * fum_children[1, 2]))
my_dat<- read.csv('insurance.csv', header = TRUE, sep= ",", quote = '\"')
my_dat <-  my_dat[c(1, 3, 4, 5, 7)]
fumadores    <- my_dat[my_dat$smoker == 'yes', ]
no_fumadores <- my_dat[my_dat$smoker == 'no' , ]
mod_lin_funct <- function(x, y){
media_x = mean(x); media_y = mean(y)
dif_x <- x - media_x
dif_y <- y - media_y
b_1 <- sum(dif_x * dif_y) / sum(dif_x ^ 2)
b_0 <- media_y - b_1 * media_x
y_gorro <- b_0 + x * b_1
SSM <- sum((y_gorro - media_y)^2)
SST <- sum((y - media_y)^2)
r_sqr <- SSM / SST
N = length(x); k = 1
r_sqr_a <- 1 - ((N - 1)/(N - k - 1))*(1 - r_sqr)
data.frame(b_0, b_1, r_sqr, r_sqr_a)
}
fum_age <- mod_lin_funct(fumadores$age, fumadores$charges)
fum_bmi <- mod_lin_funct(fumadores$bmi, fumadores$charges)
fum_children <- mod_lin_funct(fumadores$children, fumadores$charges)
no_fum_age <- mod_lin_funct(no_fumadores$age, no_fumadores$charges)
no_fum_bmi <- mod_lin_funct(no_fumadores$bmi, no_fumadores$charges)
no_fum_children <- mod_lin_funct(no_fumadores$children, no_fumadores$charges)
Tags <- c("fum_age", "fum_bmi", "fum_children",
"no_fum_age", "no_fum_bmi", "no_fum_children")
b_0 <- c(fum_age$b_0, fum_bmi$b_0, fum_children$b_0,
no_fum_age$b_0, no_fum_bmi$b_0, no_fum_children$b_0)
b_1 <-c(fum_age$b_1, fum_bmi$b_1, fum_children$b_1,
no_fum_age$b_1, no_fum_bmi$b_1, no_fum_children$b_1)
r_sqr <- c(fum_age$r_sqr, fum_bmi$r_sqr, fum_children$r_sqr,
no_fum_age$r_sqr, no_fum_bmi$r_sqr, no_fum_children$r_sqr)
r_sqr_a <- c(fum_age$r_sqr_a, fum_bmi$r_sqr_a, fum_children$r_sqr_a,
no_fum_age$r_sqr_a, no_fum_bmi$r_sqr_a, no_fum_children$r_sqr_a)
resultados <- data.frame(Tags, b_0, b_1, r_sqr, r_sqr_a)
print(resultados)
library(ggplot2)
ggplot(fumadores, aes(x=bmi, y=charges)) +
geom_point(size=2, shape=23) +
geom_line(y = (fum_children[1, 1] + sort(fumadores$bmi) * fum_children[1, 2]))
library(ggplot2)
ggplot(fumadores, aes(x=bmi, y=charges)) +
geom_point(size=2, shape=23) +
geom_line(y = (fum_bmi[1, 1] + sort(fumadores$bmi) * fum_bmi[1, 2]))
ggplot(no_fumadores, aes(x=children, y=charges)) +
geom_point(size=2, shape=23) +
geom_line(y = (no_fum_children[1, 1] + sort(no_fumadores$children) * no_fum_children[1, 2]))
corplot(fumadores)
plot(cor(fumadores)
plot(cor(fumadores))
corrplot(cor(fumadores))
corrplot(cor(fumadores))
library(corrplot)
corrplot(cor(fumadores))
corrplot(cor(fumadores[c(1, 2, 3, 5)]))
corrplot(cor(no_fumadores[c(1, 2, 3, 5)]))
ggplot(no_fumadores, aes(x=age, y=charges)) +
geom_point(size=2, shape=23) +
geom_line(y = (no_fum_age[1, 1] + sort(no_fumadores$age) * no_fum_age[1, 2]))
lm_reg <- function(X, Y){
inv((X %*% t(X))) %*% t(X) %*% Y
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
lm_reg <- function(X, Y){
solve((X %*% t(X))) %*% t(X) %*% Y
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
lm_reg <- function(X, Y){
X <- as.matrix(X)
Y <- as.matrix(Y)
solve((X %*% t(X))) %*% t(X) %*% Y
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
lm_reg <- function(X, Y){
X <- as.matrix(X)
Y <- as.matrix(Y)
solve((X %*% t(X)), tol=1e-15) %*% t(X) %*% Y
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
lm_reg <- function(X, Y){
X <- as.matrix(X)
Y <- as.matrix(Y)
solve((X %*% t(X)), tol = 1e-15) %*% t(X) %*% Y
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
lm_reg <- function(X, Y){
X <- as.matrix(X)
Y <- as.matrix(Y)
solve((X %*% t(X)), tol = 1e-17) %*% t(X) %*% Y
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
lm_reg <- function(X, Y){
X <- as.matrix(X)
Y <- as.matrix(Y)
solve((X %*% t(X)), tol = 0.0000000001) %*% t(X) %*% Y
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
lm_reg <- function(X, Y){
X <- as.matrix(X)
Y <- as.matrix(Y)
solve((X %*% t(X)), tol = 0.0000000000000000000000000000001) %*% t(X) %*% Y
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
lm_reg <- function(X, Y){
X <- as.matrix(X)
Y <- as.matrix(Y)
solve((X * t(X)), tol = 0.0000000000000000000000000000001) * t(X) * Y
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
lm_reg <- function(X, Y){
X <- as.matrix(X)
Y <- as.matrix(Y)
solve((X %*% t(X)), tol = 0.0000000000000000000000000000001) %*% t(X) %*% Y
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
lm_reg <- function(X, Y){
X <- as.matrix(X)
Y <- as.matrix(Y)
u1 <-(X %*% t(X))
u2 <- solve(u1, tol = 0.0000000000000000000000000000001)
u3 <- t(X)
u2 %*% u3 %*% Y
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
lm_reg <- function(X, Y){
X <- as.matrix(X)
Y <- as.matrix(Y)
u1 <-(X %*% t(X))
u2 <- solve(u1, tol = 0.0000000000000000000000000000001)
u3 <- t(X)
u2 %*% (u3 %*% Y)
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
lm_reg <- function(X, Y){
X <- as.matrix(X)
Y <- as.matrix(Y)
u1 <-(X %*% t(X))
u2 <- solve(u1, tol = 0.0000000000000000000000000000001)
u3 <- t(X)
u4 <- (u3 %*% Y)
u2 %*% u4
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
print(u2.size)
lm_reg <- function(X, Y){
X <- as.matrix(X)
Y <- as.matrix(Y)
u1 <-(X %*% t(X))
u2 <- solve(u1, tol = 0.0000000000000000000000000000001)
u3 <- t(X)
u4 <- (u3 %*% Y)
print(u2.size)
u2 %*% u4
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
print(length(u2))
lm_reg <- function(X, Y){
X <- as.matrix(X)
Y <- as.matrix(Y)
u1 <-(X %*% t(X))
u2 <- solve(u1, tol = 0.0000000000000000000000000000001)
u3 <- t(X)
u4 <- (u3 %*% Y)
print(length(u2))
u2 %*% u4
}
res <- lm_reg(fumadores[c(1, 2, 3)], fumadores[c(5)])
